<RibbonWindow x:Class="Samm.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:com="clr-namespace:Com.Model;assembly=Com"
        xmlns:local="clr-namespace:Samm"
        x:Name="UI"
        Title="ConceptMix Application" 
        Icon="Images\default.ico"
        DataContext="{Binding RelativeSource={RelativeSource Self}}"
        >

    <RibbonWindow.Resources>

        <!-- Grid for visualizing a set -->
        <Style x:Key="GridHeaderStyle" TargetType="{x:Type DataGridColumnHeader}">
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="FontSize" Value="12" />
        </Style>

        <Style x:Key="ReadOnlyGridStyle" TargetType="{x:Type DataGrid}" >
            <Setter Property="AutoGenerateColumns" Value="False" />
            <Setter Property="IsReadOnly" Value="True" />
            <Setter Property="GridLinesVisibility" Value="None" />
            <Setter Property="CanUserAddRows" Value="False" />
            <Setter Property="CanUserDeleteRows" Value="False" />
            <Setter Property="CanUserResizeColumns" Value="True" />
            <Setter Property="CanUserResizeRows" Value="False" />
            <Setter Property="CanUserReorderColumns" Value="True" />
            <Setter Property="ColumnHeaderStyle" Value="{StaticResource GridHeaderStyle}" />
        </Style>

        <DataTemplate x:Key="CellTemplate">
            <Border Padding="3" Background="Purple">
                <TextBox Text="{Binding Path=.}" />
            </Border>
        </DataTemplate>

        <!-- Commands can be (and should be later) defined programmatically as classes -->
        <RoutedUICommand x:Key="OpenTableCommand" Text="Open Table" />
        <RoutedUICommand x:Key="AccessDatasourceCommand" Text="Access Database" />
        <RoutedUICommand x:Key="TextDatasourceCommand" Text="Text Table" />
        <RoutedUICommand x:Key="SqlserverDatasourceCommand" Text="Sql Server Database" />
        <RoutedUICommand x:Key="ImportTableCommand" Text="Import Table" />
        <RoutedUICommand x:Key="FilteredTableCommand" Text="Filter Table" />
        <RoutedUICommand x:Key="ExtractTableCommand" Text="Extract Table" />
        <RoutedUICommand x:Key="AddAggregationCommand" Text="Add Aggregation" />
        <RoutedUICommand x:Key="AddCalculationCommand" Text="Add Calculation" />
        <RoutedUICommand x:Key="ChangeRangeCommand" Text="Change Column Type" />
        <RoutedUICommand x:Key="AboutCommand" Text="About" />

    </RibbonWindow.Resources>

    <Window.CommandBindings>
        <CommandBinding Command="{StaticResource OpenTableCommand}" Executed="OpenTableCommand_Executed" />
        <CommandBinding Command="{StaticResource AccessDatasourceCommand}" Executed="AccessDatasourceCommand_Executed" />
        <CommandBinding Command="{StaticResource TextDatasourceCommand}" Executed="TextDatasourceCommand_Executed" />
        <CommandBinding Command="{StaticResource SqlserverDatasourceCommand}" Executed="SqlserverDatasourceCommand_Executed" />
        <CommandBinding Command="{StaticResource ImportTableCommand}" Executed="ImportTableCommand_Executed" />
        <CommandBinding Command="{StaticResource FilteredTableCommand}" Executed="FilteredTableCommand_Executed" />
        <CommandBinding Command="{StaticResource ExtractTableCommand}" Executed="ExtractTableCommand_Executed" />
        <CommandBinding Command="{StaticResource AddAggregationCommand}" Executed="AddAggregationCommand_Executed" />
        <CommandBinding Command="{StaticResource AddCalculationCommand}" Executed="AddCalculationCommand_Executed" />
        <CommandBinding Command="{StaticResource ChangeRangeCommand}" Executed="ChangeTypeCommand_Executed" />
        <CommandBinding Command="{StaticResource AboutCommand}" Executed="AboutCommand_Executed" />
    </Window.CommandBindings>

    <DockPanel LastChildFill="True">

        <Ribbon x:Name="RibbonWin" DockPanel.Dock="Top" SelectedIndex="0">

            <!-- Help Pane, located at the right-hand side -->
            <Ribbon.HelpPaneContent>
                <RibbonButton SmallImageSource="Images\help.png" />
            </Ribbon.HelpPaneContent>

            <!-- Quick Access Toolbar - located at the upper-left corner -->
            <Ribbon.QuickAccessToolBar>
                <RibbonQuickAccessToolBar>
                    <RibbonButton x:Name ="Save" SmallImageSource="Images\default.ico" />
                    <RibbonSplitButton x:Name ="Update" SmallImageSource="Images\default.ico">
                        <RibbonSplitMenuItem Header="Update All"/>
                        <RibbonSplitMenuItem Header="Update local (recompute)"/>
                        <RibbonSplitMenuItem Header="Update table (and depending tables)"/>
                    </RibbonSplitButton>
                </RibbonQuickAccessToolBar>
            </Ribbon.QuickAccessToolBar>

            <!-- Application Menu, located at the left-hand side (down arrow) -->
            <Ribbon.ApplicationMenu>
                <RibbonApplicationMenu KeyTip="F">
                    <RibbonApplicationMenuItem Header="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}" ImageSource="Images\default.ico" Command="ApplicationCommands.New"/>
                    <RibbonApplicationMenuItem Header="Open" ImageSource="Images\default.ico" Command="ApplicationCommands.Open"/>
                    <RibbonApplicationMenuItem Header="Close" ImageSource="Images\default.ico" Command="ApplicationCommands.Close"/>
                    <RibbonApplicationMenuItem Header="Save" ImageSource="Images\default.ico" Command="ApplicationCommands.Save"/>
                    <RibbonApplicationMenuItem Header="Save As..." ImageSource="Images\default.ico" Command="ApplicationCommands.SaveAs"/>
                    <RibbonApplicationMenuItem Header="Options" ImageSource="Images\default.ico" />
                    <RibbonApplicationMenuItem Header="About" ImageSource="Images\default.ico" Command="{StaticResource AboutCommand}" />
                    <RibbonApplicationMenuItem Header="Exit" ImageSource="Images\default.ico" />
                </RibbonApplicationMenu>
            </Ribbon.ApplicationMenu>

            <!-- Ribbon Tab Home/File -->
            <RibbonTab Header="Home" KeyTip="H" >
                <!-- Home  group-->
                <RibbonGroup x:Name="ClipboardGroup" Header="Home">
                    <RibbonMenuButton LargeImageSource="Images\paste.png" Label="Paste" KeyTip="V">
                        <RibbonMenuItem ImageSource="Images\paste.png" Header="Keep Text Only" KeyTip="T"/>
                        <RibbonMenuItem ImageSource="Images\paste.png" Header="Paste Special..." KeyTip="S"/>
                    </RibbonMenuButton>
                    <RibbonButton SmallImageSource="Images\cut.png" Label="Cut" KeyTip="X" />
                    <RibbonButton SmallImageSource="Images\copy.png" Label="Copy" KeyTip="C" />
                </RibbonGroup>
                <RibbonGroup Header="Connections">
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Add Connection" KeyTip="A"/>
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Search for Data Source" KeyTip="S"/>
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Remove Connection" KeyTip="R"/>
                </RibbonGroup>
            </RibbonTab>

            <!-- Ribbon Tab View -->
            <RibbonTab Header="View" KeyTip="V">
                <RibbonGroup x:Name="windowGroup" Header="Window">
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Window" KeyTip="W" />
                </RibbonGroup>
            </RibbonTab>

            <RibbonTab Header="Import" KeyTip="I">
                <RibbonGroup x:Name="importDatasourceGroup" Header="Data Sources">
                    <RibbonButton LargeImageSource="Images\add_access.png" Label="Access Database" KeyTip="A" Command="{StaticResource AccessDatasourceCommand}" />
                    <RibbonButton LargeImageSource="Images\add_csv.png" Label="Text Table" KeyTip="T" Command="{StaticResource TextDatasourceCommand}" />
                    <RibbonButton LargeImageSource="Images\add_sql_server.png" Label="SQL Server" KeyTip="X" Command="{StaticResource SqlserverDatasourceCommand}" />
                    <RibbonButton LargeImageSource="Images\add_odata.png" Label="OData" KeyTip="R"/>
                    <RibbonButton LargeImageSource="Images\remove_connection.png" Label="Remove Data Source" KeyTip="R"/>
                </RibbonGroup>
                <RibbonGroup x:Name="importTableGroup" Header="Import">
                    <RibbonButton LargeImageSource="Images\import_table.png" Label="Import Table" KeyTip="I" Command="{StaticResource ImportTableCommand}" />
                </RibbonGroup>
                <RibbonGroup Header="Update">
                    <RibbonButton LargeImageSource="Images\update_all.png" Label="Update All" KeyTip="A" />
                    <RibbonButton LargeImageSource="Images\update_all.png" Label="Update Local" KeyTip="L" />
                    <RibbonButton LargeImageSource="Images\update_table.png" Label="Update Table" KeyTip="T" />
                    <RibbonButton LargeImageSource="Images\update_column.png" Label="Update Column" KeyTip="C" />
                </RibbonGroup>
            </RibbonTab>

            <RibbonTab Header="Refactor" KeyTip="R" >
                <RibbonGroup x:Name="insertTablesMenuGroup" Header="Refactor Tables">
                    <RibbonButton LargeImageSource="Images\filtered_table.png" Label="Add Filtered Table" KeyTip="F" ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Label}" Command="{StaticResource FilteredTableCommand}" />
                    <RibbonButton LargeImageSource="Images\extract_table.png" Label="Extract Table" KeyTip="X" Command="{StaticResource ExtractTableCommand}" /><!-- Create one greater table and a new dimension referencing it. -->
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Split: Extract Subtables" KeyTip="S" /> <!-- Create several lesser sub tables (extensions by-reference or by-value). One subtable for each unique value of the selected column. -->
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Merge Table" KeyTip="M" /> <!-- Convert all pairs of lesser-greater dimension in one segment and remove this table. It is opposite to extract table operation. -->
                    <RibbonButton LargeImageSource="Images\delete_table.png" Label="Delete Table with All Columns" KeyTip="D" />
                </RibbonGroup>
                <RibbonGroup x:Name="insertColumnsMenuGroup" Header="Refactor Columns">
                    <RibbonButton LargeImageSource="Images\add_aggregation.png" Label="Add Aggregation Column" KeyTip="A" Command="{StaticResource AddAggregationCommand}" />
                    <RibbonButton LargeImageSource="Images\add_calculation.png" Label="Add Arithmetic Column" KeyTip="R" Command="{StaticResource AddCalculationCommand}" />
                    <RibbonButton LargeImageSource="Images\change_type2.png" Label="Change Column Type" KeyTip="T" Command="{StaticResource ChangeRangeCommand}" />
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Split Column" KeyTip="S" />
                    <!-- <RibbonButton LargeImageSource="Images\default.ico" Label="Merge Column Path" KeyTip="M" /> Convert two or segments into one segment. It is one operation in merge table operation all pairs are merged -->
                    <RibbonButton LargeImageSource="Images\delete_column.png" Label="Delete Column" KeyTip="D" />
                </RibbonGroup>
                <RibbonGroup Header="Selection Propagation">
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Propagate All" KeyTip="A"  />
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Propagate From Table" KeyTip="F" />
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Propagate To Table" KeyTip="T" />
                </RibbonGroup>
            </RibbonTab>

            <RibbonTab Header="Export" KeyTip="E">
                <RibbonGroup x:Name="exportGroup" Header="Data Sources">
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Access Database" KeyTip="A" />
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Text Table" KeyTip="T" />
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Excel" KeyTip="R"/>
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Remove Data Source" KeyTip="R"/>
                </RibbonGroup>
                <RibbonGroup x:Name="exportTableGroup" Header="Export">
                    <RibbonButton LargeImageSource="Images\default.ico" Label="Export Table" KeyTip="E" />
                </RibbonGroup>
            </RibbonTab>

        </Ribbon>

        <StatusBar DockPanel.Dock="Bottom">
            <StatusBarItem>
                <TextBlock Name="statBarText" Text="Ready"/>
            </StatusBarItem>
        </StatusBar>

        <Grid>
            <!-- Define the rows and columns -->
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="4*"/>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>

            <GridSplitter Grid.Column ="1" Width ="5" ResizeDirection="Columns" VerticalAlignment="Stretch" HorizontalAlignment="Center" Background ="AliceBlue" />
            <GridSplitter Grid.Column ="3" Width ="5" ResizeDirection="Columns" VerticalAlignment="Stretch" HorizontalAlignment="Center" Background ="AliceBlue" />

            <!-- Data source panel -->
            <Grid Name="DsPanel" Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Label Name="lblDatasources" Grid.Row="0" FontSize="16" Margin="5" >Data sources</Label>

                <local:SubsetTreeControl 
                    x:Name="SourcesView" 
                    Grid.Column="0" Grid.Row="1" 
                    DataContext="{Binding Path=SourcesModel}" 
                    />
            </Grid>

            <!-- Workspace panel -->
            <Grid Name="WorkspacePanel" Grid.Column="2" >
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Label Name="lblWorkspace" Grid.Row="0" FontSize="16" Margin="5">WORKSPACE PANEL</Label>

                <ContentControl Name="GridPanel" Grid.Row="1">
                </ContentControl>
            </Grid>

            <!-- Mashup panel -->
            <Grid Name="MashupPanel" Grid.Column="4" >
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Label Name="lblMashup" Grid.Row="0" FontSize="16" Margin="5">Data mashup</Label>

                <local:SubsetTreeControl 
                    x:Name="MashupsView" 
                    Grid.Column="0" Grid.Row="1" 
                    DataContext="{Binding Path=MashupsModel}" 
                    />

<!--
                <TreeView 
                    Name="SubsetTree" 
                    Grid.Column="0" Grid.Row="2" 
                    ItemsSource="{Binding Path=MashupTreeTop}" 
                    BorderThickness="5" 
                    ScrollViewer.VerticalScrollBarVisibility="Visible" 
                    ScrollViewer.HorizontalScrollBarVisibility="Auto" 
                    >

                    <TreeView.ItemTemplate>
                        <HierarchicalDataTemplate ItemsSource="{Binding Path=.}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding Path=Dim.LesserSet.Name}" />
                            </StackPanel>
                        </HierarchicalDataTemplate>
                    </TreeView.ItemTemplate>

                </TreeView>
-->
            </Grid>

        </Grid>

    </DockPanel>
</RibbonWindow>
